<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Skin Retoucher Pro - 專業膚質修飾工具</title>
    <!-- 引入 Google Fonts 以提供更好的字體顯示 -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <!-- 連結主要的 CSS 樣式表 -->
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- 主容器 -->
    <div class="main-container">
        <!-- 左側畫布容器 -->
        <div class="canvas-container">
            <canvas id="gl-canvas"></canvas>
            <div class="preview-container">
                <canvas id="mask-preview-canvas"></canvas>
                <p>
                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 5c-7.2 0-11 7-11 7s3.8 7 11 7 11-7 11-7-3.8-7-11-7Z"/><circle cx="12" cy="12" r="3"/></svg>
                    遮罩預覽
                </p>
            </div>
        </div>
        <!-- 右側控制項容器 -->
        <div class="controls-container">
            <!-- 處理參數區 -->
            <div class="section">
                <h2>
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 0 2l-.15.08a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.38a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1 0-2l.15-.08a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"/><circle cx="12" cy="12" r="3"/></svg>
                    處理參數
                </h2>
                <div class="control-group">
                    <label for="radius-slider">✨ 平滑度: <span id="radius-value">10</span></label>
                    <input type="range" id="radius-slider" min="0" max="100" value="10" step="0.1">
                </div>
                <div class="control-group">
                    <label for="detail-slider">🔍 細節保留: <span id="detail-value">70</span>%</label>
                    <input type="range" id="detail-slider" min="0" max="100" value="70" step="1">
                </div>
            </div>

            <!-- 膚色選取區 -->
            <div class="section">
                <h2>
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z"/><circle cx="12" cy="10" r="3"/></svg>
                    膚色選取
                </h2>
                <p class="instructions">在圖片上按「右鍵」選取最多10個膚色樣本。</p>
                <div class="control-group">
                    <label for="tolerance-slider">💧 顏色容差: <span id="tolerance-value">20</span></label>
                    <input type="range" id="tolerance-slider" min="0" max="100" value="20" step="1">
                </div>
                <div class="control-group">
                    <label for="expansion-slider">➕ 遮罩擴張: <span id="expansion-value">25</span></label>
                    <input type="range" id="expansion-slider" min="0" max="100" value="25" step="1">
                </div>
                <div class="color-swatches" id="color-swatches"></div>
                <button id="clear-colors-btn" class="button-secondary">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/><line x1="10" y1="11" x2="10" y2="17"/><line x1="14" y1="11" x2="14" y2="17"/></svg>
                    清除選取
                </button>
            </div>

            <!-- 除錯檢視區 -->
            <div class="section">
                <h2>
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 12c0 1.66-1.34 3-3 3s-3-1.34-3-3 1.34-3 3-3 3 1.34 3 3z"/><path d="M21.64 7.64c.23-.46.36-.96.36-1.49 0-2.8-2.2-5.15-5-5.15-.53 0-1.03.13-1.49.36-.46-.23-.96-.36-1.49-.36-2.8 0-5.15 2.2-5.15 5 0 .53.13 1.03.36 1.49-.23.46-.36.96-.36 1.49 0 2.8 2.2 5.15 5 5.15.53 0 1.03-.13 1.49-.36.46.23.96.36 1.49.36 2.8 0 5.15-2.2 5.15-5 0-.53-.13-1.03-.36-1.49zM12 15c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3z"/></svg>
                    除錯檢視
                </h2>
                <div class="control-group radio-group" id="view-mode-group">
                    <div>
                        <input type="radio" id="view-final" name="view-mode" value="final" checked>
                        <label for="view-final">最終結果</label>
                    </div>
                    <div>
                        <input type="radio" id="view-high" name="view-mode" value="high">
                        <label for="view-high">高頻層 (紋理)</label>
                    </div>
                    <div>
                        <input type="radio" id="view-low" name="view-mode" value="low">
                        <label for="view-low">低頻層 (顏色)</label>
                    </div>
                </div>
            </div>

            <!-- 批次處理與主操作按鈕 -->
            <div class="main-actions-container">
                <div class="section batch-section">
                    <h2>
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2"/><path d="M8 12h8"/><path d="M12 8v8"/></svg>
                        批次處理
                    </h2>
                    <p class="instructions" id="batch-instructions">選取多張圖片以開始批次處理。</p>
                    <div class="batch-progress" id="batch-progress" style="display: none;">
                        <div class="progress-bar-container">
                            <div class="progress-bar" id="batch-progress-bar"></div>
                        </div>
                        <pre class="log-area" id="batch-log"></pre>
                    </div>
                    <button id="start-batch-btn" style="display: none;" disabled>✨ 開始批-次修飾</button>
                </div>

                <div class="button-group">
                    <button id="load-btn">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg>
                        載入圖片
                    </button>
                    <button id="save-btn">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/><polyline points="17 21 17 13 7 13 7 21"/><polyline points="7 3 7 8 15 8"/></svg>
                        儲存圖片
                    </button>
                    <button id="batch-btn">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 12h-4l-3 9L9 3l-3 9H2"/></svg>
                        選擇批次圖片
                    </button>
                </div>
            </div>
        </div>
    </div>
    <!-- 隱藏的檔案輸入元素 -->
    <input type="file" id="file-input" accept="image/*" style="display: none;">
    <!-- 引入渲染程序的主腳本 -->
    <script type="module" src="renderer.js"></script>
</body>
</html>